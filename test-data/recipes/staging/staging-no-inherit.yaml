# New test case: Staging output that's used as a build step but not inherited
# Tests that staging can be used just for its side effects (building common artifacts)
# without package outputs explicitly inheriting from it

schema_version: 1

recipe:
  name: side-effect-staging
  version: 1.0.0

outputs:
  # Staging output that prepares shared resources
  - staging:
      name: prepare-resources
    build:
      script:
        - mkdir -p $PREFIX/resources
        - echo "Generated resource file" > $PREFIX/resources/generated.txt
        - echo "Build timestamp: $(date)" > $PREFIX/resources/timestamp.txt

  # Package outputs that don't explicitly inherit but benefit from staging
  # (This tests that the staging cache is built even if not inherited)
  - package:
      name: package-a
      version: 1.0.0
    build:
      script:
        # This package builds independently but staging ran first
        - echo "Package A" > $PREFIX/package-a.txt
      files:
        - package-a.txt

  - package:
      name: package-b
      version: 1.0.0
    build:
      script:
        - echo "Package B" > $PREFIX/package-b.txt
      files:
        - package-b.txt
